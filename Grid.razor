@namespace DataJuggler.Blazor.Components
@using DataJuggler.UltimateHelper
@using DataJuggler.Excelerate;
@using DataJuggler.Blazor.Components.Objects
@using BlazorStyled

<Styled @bind-Classname=@ContainerStyle>    
    visibility: @Visibility;
    position: @Position;
    left: @LeftStyle;
    top: @TopStyle;    
</Styled>
<Styled @bind-Classname=@GridStyle>    
    background-color: @GridBackColor.Name;
    height: @HeightStyle;
    line-height: 2vh;
    font-size: @FontSizeStyle;
    width: @WidthStyle;
    border-width: @BorderWidthStyle;
    border-color: @BorderColor.Name;
    --scrollbar-width: @ScrollBarWidthStyle;
    --scrollbar-track: @ScrollBarTrackColor.Name;
    --scrollbar-thumb: @ScrollBarThumbColor.Name;
    --scrollbar-thumb-hover: @ScrollBarThumbHoverColor.Name;
    --scrollbar-radius: @ScrollBarRadiusStyle;
    --scrollbar-track-border: @ScrollBarTrackBorderColor.Name;
</Styled>
<Styled @bind-Classname=@ScrollStyle>
    overflow-y: @OverflowY;
    overflow-x: @OverflowX;
</Styled>
<Styled @bind-Classname=@GridBorderStyle>    
    border-width: @BorderWidthStyle;
    border-color: @BorderColor.Name;
    border-style: @BorderStyle;
</Styled>
<Styled @bind-Classname=@HeaderStyle>
    background-color: @HeaderColor.Name;
    height: @HeaderHeightStyle;
    clear: both;
    width: 100%;
</Styled>
<Styled @bind-Classname=@ColumnHeaderStyle>    
    background-color: @ColumnHeaderColor.Name;
    position: @StickyStyle;
    clear: both;
    height: @ColumnHeaderHeightStyle;
    width: 100%;
</Styled>
<Styled @bind-Classname=@ContentStyle>
    position: @Position;
    left: @ContentLeftStyle;
    top: @ContentTopStyle;
</Styled>
<Styled @bind-Classname=@RowContent>
    position: @Position;
    overflow-y: @OverflowY;
    overflow-x: @OverflowX;
    height: @RowContentHeightStyle;
</Styled>

<style>
    .@(GridStyle)::-webkit-scrollbar {
        width: var(--scrollbar-width, 10px);
    }

    .@(GridStyle)::-webkit-scrollbar-track {
        background: var(--scrollbar-track, LightGray);
        border: 1px solid var(--scrollbar-track-border);
    }

    .@(GridStyle)::-webkit-scrollbar-thumb {
        background-color: var(--scrollbar-thumb, DarkGray);
        border-radius: var(--scrollbar-radius, 6px);
    }

    .@(GridStyle)::-webkit-scrollbar-thumb:hover {
        background-color: var(--scrollbar-thumb-hover, DimGray);
    }    
</style>

<div class="@ContainerStyle">
    @if (ShowHeader)
    {
        <div class="@HeaderStyle @HeaderClassName">
            @HeaderText
        </div>
    }
    <div class="@GridStyle @GridBorderStyle @ClassName @ScrollStyle">
        <div class="@ContentStyle">
            <table class="tablelayoutfixed bordercollapse">
                @if (GridColumns != null)
                {
                    @GridColumns(this)
                }

                @if (HasColumns)
                {  
                    <colgroup>
                        @foreach (Column column in Columns)
                        {
                            <col class="@column.ClassName" />
                        }
                    </colgroup>
                }
                @if ((ShowColumnHeaders) && (HasColumns))
                {
                    <thead>
                    <tr class="@ColumnHeaderStyle @ColumnHeaderClassName">
                        @foreach (Column column in Columns)
                        {
                            <th class="@column.ClassName">@column.Caption</th>
                        }
                    </tr>
                    </thead>
                }
                @if (HasRows)
                { 
                    <tbody class="@RowContentInUse">
                    @foreach (Row row in Rows)
                    {
                        // if the row has columns
                        if (row.HasColumns)
                        {
                            <tr class="@row.ClassName">
                            @foreach (Column column in row.Columns)
                            {
                                if (column.IsImageButton)
                                {
                                    <td>
                                        <ImageButton ClickHandler=@ButtonClickHandler Unit="@column.Unit" ImageUrl="@column.ButtonUrl" 
                                            Width="@column.Width" Height="@column.Height" ButtonNumber=@column.ButtonNumber Name="@column.ColumnName"
                                            Text="@column.ColumnText" Visible=true Parent="this"></ImageButton>
                                    </td>
                                }
                                else if (column.IsImage)
                                {
                                    <td>
                                        <ImageComponent Unit="@column.Unit" ImageUrl="@column.ImageUrl" 
                                            Width="@column.Width" Height="@column.Height" Name="@column.ColumnName"
                                            Text="@column.ColumnText" Visible=true Parent="this"></ImageComponent>
                                    </td>
                                }
                                else if ((row.EditMode) && (!column.ReadOnly) && (column.EditMode))
                                {
                                    <td class="displayinline @column.ClassName">
                                    <TextBoxComponent Name=column.ColumnName Unit="@column.Unit" Width=column.Width 
                                        Height=column.Height RowId=row.Id ColumnId=column.Id ZIndex="@column.ZIndex"
                                        SetFocusOnFirstRender=column.SetFocusOnFirstRender ClassName="@column.EditorClassName"
                                        Text="@column.EditorText"  Parent=this></TextBoxComponent>
                                    </td>
                                }
                                else if (EnableClick)
                                {
                                    <td class="@column.ClassName" @onclick="() => OnClick(row, column.ColumnNumber)">@column.ColumnText</td>
                                }
                                else if (EnableDoubleClick)
                                {
                                    <td class="@column.ClassName" @ondblclick="() => OnDoubleClick(row, column.ColumnNumber)">@column.ColumnText</td>
                                }
                                else
                                {
                                    <td class="@column.ClassName">@column.ColumnText</td>
                                }
                            }
                            </tr>
                        }
                    }
                    </tbody>
                }
            </table>
        </div>        
    </div>
</div>